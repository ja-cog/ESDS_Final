---
title: "Final"
author: "Jacob Coggshall"
date: "2023-06-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r}
library(here)
library(dplyr)
library(janitor)
library(ggplot2)
library(tidyverse)
library(naniar)
library(skimr)
library(GGally)
library(flextable)
```

```{r}
bank <- read_csv(here("data", "sev208_kratseedbank_20120213.csv")) |>
  clean_names() |>
  mutate(seed_count = seeds,
         mound = mnd,
         direction = dir,
         location = loc) |>
  select(-seeds, -mnd, -dir, -loc) |>
  filter(seed_count != 0)
```

```{r}
gg_miss_var(bank)
```

Null Hypothesis (H0): There is no difference in the total seed number between kangaroo rat mound locations.

Alternative Hypothesis (HA): There is a difference in the total seed number between kangaroo rat mound locations.


```{r}
#Creating a model object
model <- aov(seed_count ~ location, data = bank)
```

```{r}
# Set the theme
theme_set(theme_minimal())

# Create the histogram
ggplot(data = bank, aes(x = seed_count)) +
  geom_histogram(bins = 6, fill = "steelblue", color = "black") +
  labs(x = "Seed Count", y = "Frequency", title = "Seed Count Histogram") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())
```

Histogram to check distribution

```{r}
# Perform Levene's test
levene_test <- car::leveneTest(seed_count ~ location, data = bank)

# Print the test statistic and p-value
print(levene_test)
```

Levene's test is a test for homogeneity of variances, which checks if the variances of the seed_count variable are equal across the location groups. The test statistic (F-value) is 12.414, and the associated p-value is very small (less than 0.001). This suggests that there is strong evidence to reject the null hypothesis, indicating that the variances of seed_count are significantly different across the location groups.



```{r}
summary(model)
```
Summary Results:

Null hypothesis (H0): There is no significant difference in the mean seed count between kangaroo rat mound locations.

Alternative hypothesis (HA): There is a significant difference in the mean seed count between kangaroo rat mound locations.

Test statistic: F value = 0.154

p-value: 0.695
Conclusion: The p-value is greater than the significance level (typically 0.05), so we fail to reject the null hypothesis. This means that there is no significant evidence to suggest a difference in the mean seed count between kangaroo rat mound locations based on the ANOVA test.


```{r}
#Running Kruskal Wallis rank sum test
kruskal.test(seed_count ~ location, data = bank)
```
Null hypothesis (H0): There is no significant difference in the distribution of seed count between kangaroo rat mound locations.

Alternative hypothesis (HA): There is a significant difference in the distribution of seed count between kangaroo rat mound locations.

Test statistic: Kruskal-Wallis chi-squared = 7.4789
p-value: 0.5874

Conclusion: The p-value is greater than the significance level of 0.05, so we fail to reject the null hypothesis. This means that there is no significant evidence to suggest a difference in the distribution of seed count between kangaroo rat mound locations based on the Kruskal-Wallis test.



```{r}
ggplot(data = bank, aes(x = location, y = seed_count)) +
  geom_jitter(trim = FALSE) +
  labs(x = "Mound Location", y = "Total Seed Number") +
  ggtitle("Distribution of Total Seed Number by Mound Location") +
  theme(plot.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 12),
        plot.background = element_rect(fill = "white"),
        panel.background = element_rect(fill = "white"),
        panel.grid.major = element_line(color = "gray", linetype = "dashed"))
```

"Distribution of Total Seed Number by Mound Location: The plot illustrates the variation in total seed numbers for different mound locations. Each point represents a data point, with the vertical position indicating the seed count value. Jittering is applied to prevent overlapping points. The x-axis represents the mound locations: B (base of kangaroo rat mound on the mound), D (surrounding area of kangaroo rat mound on the mound), E (edge of Bouteloua eripoda grass clumps off the mound), and I (interspace between black grama grass clumps off the mound). The y-axis represents the total seed number."


```{r}

```

